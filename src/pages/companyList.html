<div id="company-list">
  <div class="header">企業一覧　画面</div>
  <div>
    <div style="padding-top: 1%">
      <button onClick="changeScreen('company-entry')">企業追加</button>
      <button onClick="changeScreen('schedule-list')">全ての予定</button>
      志望度
      <select id="company-desire" onchange="sortByDesire()">
        <option value="">-</option>
        <option value="high">高</option>
        <option value="middle">中</option>
        <option value="low">低</option>
      </select>
    </div>
    <ul style="padding: 1%" id="companys-list"></ul>
    <ul style="padding: 1%" id="companys-list-by-desire"></ul>
  </div>
</div>
<script>
  google.script.run
    .withSuccessHandler(function (data) {
      const companyList = document.getElementById("companys-list");
      for (let i = 0; i < data.length; i++) {
        const li = document.createElement("li");
        companyList.appendChild(li);
        const companyName = document.createElement("a");
        companyName.innerText = data[i];
        companyList.appendChild(companyName);
        createBtn(
          companyList,
          "scheduleBtn",
          "スケジュール",
          "schedule-btn",
          "changeScreen('schedule-list')"
        );
        createBtn(
          companyList,
          "fixBtn",
          "編集",
          "fix-btn",
          "changeScreen('company-entry')"
        );
        createBtn(
          companyList,
          "deleteBtn",
          "削除",
          "delete-btn",
          "changeScreen('company-entry')" // 後から別の機能に変更する。createBtnを使うための応急処置。
        );
      }
    })
    .getAllCompanys();

  function createBtn(companyList, btnName, inner, className, clickedFunction) {
    const btn = document.createElement("button");
    btn.setAttribute("class", className);
    btn.innerHTML = inner;
    companyList.appendChild(btn);
    btn.setAttribute("onclick", clickedFunction);
  }

  function sortByDesire() {
    const companyDesire = document.getElementById("company-desire").value;
    const companyList = document.getElementById("companys-list-by-desire");
    document.getElementById("companys-list").style.display = "none";
    while (companyList.lastChild) {
      companyList.removeChild(companyList.lastChild);
    }

    google.script.run
      .withSuccessHandler((data) => {
        alert(data);
        for (let i = 0; i < data.length; i++) {
          const li = document.createElement("li");
          companyList.appendChild(li);
          const companyName = document.createElement("a");
          companyName.innerText = data[i];
          companyList.appendChild(companyName);

          createBtn(
            companyList,
            "scheduleBtn",
            "スケジュール",
            "schedule-btn",
            "changeScreen('schedule-list')"
          );
          createBtn(
            companyList,
            "fixBtn",
            "編集",
            "fix-btn",
            "changeScreen('company-entry')"
          );
          createBtn(
            companyList,
            "deleteBtn",
            "削除",
            "delete-btn",
            "changeScreen('company-entry')" // 後から別の機能に変更する。createBtnを使うための応急処置。
          );
        }
      })
      .getCompanysByDesire(companyDesire);
  }

  function showCompanysList() {}
</script>
